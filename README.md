# 狼人杀游戏 - 9人标准局

一个支持人类与AI混合对战的狼人杀游戏，使用AWS Bedrock的多种AI模型作为AI玩家。

## 游戏特性

- **9人标准局配置**：3狼人 + 3村民 + 3神职（预言家、女巫、猎人）
- **多种游戏模式**：
  - 纯AI对战（观战模式）
  - 1名人类 + 8名AI
  - 自定义人类玩家数量（1-9人）
- **多样化AI模型**：使用9个不同的AWS Bedrock AI模型，每个角色有独特的思维方式
- **完整游戏流程**：包含夜晚行动、白天发言、投票放逐等完整环节

## 角色配置

### 狼人阵营
- **3名狼人**
  - 每晚集体讨论并击杀1名玩家
  - 互相认识队友
  - 胜利条件：屠杀所有神职或所有平民

### 神职阵营
- **预言家**
  - 每晚可查验1名玩家的身份（好人/狼人）
  - 需在白天引导好人阵营

- **女巫**
  - 拥有解药1瓶（救活当晚被杀的人）
  - 拥有毒药1瓶（毒死1名玩家）
  - 每晚最多使用1瓶药，同一晚不能同时使用两瓶
  - 不能自救

- **猎人**
  - 被狼人杀死或被投票放逐时，可开枪带走1名玩家
  - 被女巫毒死不能开枪

### 平民阵营
- **3名村民**
  - 无特殊技能
  - 通过逻辑推理找出狼人

## AI模型分配

当所有玩家都是AI时，默认模型分配如下：

| 角色 | AI模型 |
|------|--------|
| 狼人1 | claude-opus-4-20250514 |
| 狼人2 | claude-sonnet-4-5-20250929 |
| 狼人3 | claude-3-7-sonnet-20250219 |
| 预言家 | claude-opus-4-1-20250805 |
| 女巫 | claude-sonnet-4-20250514 |
| 猎人 | claude-sonnet-4-5-20250929 |
| 村民1 | claude-haiku-4-5-20251001 |
| 村民2 | claude-3-7-sonnet-20250219 |
| 村民3 | claude-haiku-4-5-20251001 |

**注意**：已移除DeepSeek和Claude 3.5 Sonnet模型，因为它们在当前AWS区域不可用。

## 安装

### 前置要求

- Python 3.8+
- AWS账户，并配置好AWS凭证
- 访问AWS Bedrock服务的权限

### 安装步骤

1. 克隆或下载项目：
```bash
cd open_werewolf
```

2. 创建虚拟环境（推荐）：
```bash
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate  # Windows
```

3. 安装依赖：
```bash
pip install -r requirements.txt
```

4. 配置AWS凭证：

确保你的AWS凭证已正确配置。可以通过以下方式之一：

- **方式1：使用AWS CLI配置**
  ```bash
  aws configure
  ```

- **方式2：设置环境变量**
  ```bash
  export AWS_ACCESS_KEY_ID=your_access_key
  export AWS_SECRET_ACCESS_KEY=your_secret_key
  export AWS_DEFAULT_REGION=us-west-2
  ```

- **方式3：使用.env文件**
  ```bash
  cp .env.example .env
  # 编辑.env文件，填入你的AWS凭证
  ```

## 使用方法

### 启动游戏

```bash
python main.py
```

### 游戏模式选择

启动游戏后，你需要选择人类玩家数量：

- **0** - 纯AI对战（观战模式）：观看9个AI互相博弈
- **1** - 1名人类玩家 + 8名AI：你将参与游戏
- **2-9** - 自定义人类玩家数量

### 游戏流程

1. **角色分配**：游戏开始时随机分配角色
2. **夜晚阶段**：
   - 狼人讨论并选择击杀目标
   - 预言家查验玩家身份
   - 女巫决定是否使用解药或毒药
3. **白天阶段**：
   - 宣布死亡信息
   - 遗言环节
   - 玩家依次发言
   - 投票放逐
4. **重复2-3步直到游戏结束**

### 人类玩家操作

如果你是人类玩家，在轮到你时：

- **夜晚行动**：根据提示输入玩家编号（如：1）
- **白天发言**：输入你的发言内容
- **投票**：输入你要投票的玩家编号

## 项目结构

```
open_werewolf/
├── main.py                 # 主程序入口
├── requirements.txt        # 项目依赖
├── README.md              # 项目文档
├── .env.example           # 环境变量示例
├── .gitignore            # Git忽略文件
└── src/
    ├── __init__.py
    ├── game/             # 游戏逻辑
    │   ├── __init__.py
    │   └── werewolf_game.py
    ├── models/           # 角色模型
    │   ├── __init__.py
    │   └── roles.py
    ├── players/          # 玩家系统
    │   ├── __init__.py
    │   └── player.py
    └── utils/            # 工具模块
        ├── __init__.py
        └── llm_client.py
```

## 技术特性

- **面向对象设计**：清晰的类层次结构
- **AI记忆系统**：AI玩家会记住游戏中的关键信息
- **智能决策**：基于大语言模型的推理和决策
- **完整规则实现**：严格按照9人局标准规则

## 注意事项

1. **AWS费用**：使用AWS Bedrock会产生费用，请注意控制调用次数
2. **模型可用性**：确保你的AWS账户有权限访问所有使用的模型
3. **游戏时长**：纯AI对战可能较长，建议耐心观看
4. **网络连接**：需要稳定的网络连接到AWS服务

## 开发说明

### 添加新模型

在 `src/utils/llm_client.py` 中修改 `DEFAULT_MODEL_ASSIGNMENT` 字典来自定义模型分配。

### 调整游戏规则

在 `src/game/werewolf_game.py` 中可以修改游戏流程和规则。

### 自定义角色

在 `src/models/roles.py` 中可以添加新的角色类型。

## 故障排除

### 问题：AWS认证失败

**解决方案**：
- 检查AWS凭证是否正确配置
- 确保AWS账户有Bedrock服务权限
- 检查区域设置是否为 `us-west-2`

### 问题：模型调用失败

**解决方案**：
- 确认模型在你的区域可用
- 检查是否有足够的配额
- 查看AWS控制台的Bedrock服务状态

### 问题：游戏卡住

**解决方案**：
- 检查网络连接
- 查看控制台错误信息
- 使用 Ctrl+C 中断程序

## 许可证

本项目仅供学习和娱乐使用。

## 贡献

欢迎提交问题和改进建议！

## 联系方式

如有问题，请创建 Issue。
